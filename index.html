<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Basit Subnet Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
  background:#0f172a;
  color:#e5e7eb;
}
.card {
  border-radius:1rem;
}
.ip-list {
  max-height:200px;
  overflow:auto;
  background:#020617;
  padding:10px;
  border-radius:6px;
  font-family:monospace;
}
</style>
</head>
<body>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <div class="card bg-dark text-light p-4">
        <h3 class="text-center mb-4">ğŸŒ Subnet Calculator</h3>

        <input id="ip" class="form-control mb-2" placeholder="192.168.1.10">
        <input id="cidr" type="number" class="form-control mb-3" placeholder="24">

        <button class="btn btn-primary w-100 mb-3" onclick="calculate()">Hesapla</button>

        <div id="output" class="d-none">
          <p><b>Network:</b> <span id="network"></span></p>
          <p><b>Broadcast:</b> <span id="broadcast"></span></p>
          <p><b>Gateway (Ã–nerilen):</b> <span id="gateway"></span></p>
          <p><b>KullanÄ±labilir IP SayÄ±sÄ±:</b> <span id="count"></span></p>

          <div class="ip-list mb-3" id="ipList"></div>

          <div class="d-flex gap-2">
            <button class="btn btn-success w-50" onclick="downloadCSV()">CSV Ä°ndir</button>
            <button class="btn btn-warning w-50" onclick="downloadPDF()">PDF Ä°ndir</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
let usableIPs = [];

function ipToInt(ip) {
  return ip.split('.').reduce((a,o)=> (a<<8)+Number(o),0)>>>0;
}
function intToIp(i) {
  return [(i>>>24)&255,(i>>>16)&255,(i>>>8)&255,i&255].join('.');
}

function calculate() {
  usableIPs = [];
  const ip = document.getElementById("ip").value;
  const cidr = Number(document.getElementById("cidr").value);

  const ipInt = ipToInt(ip);
  const mask = cidr === 0 ? 0 : (0xFFFFFFFF << (32-cidr))>>>0;
  const network = ipInt & mask;
  const broadcast = network | (~mask>>>0);

  for(let i=network+1;i<broadcast;i++){
    usableIPs.push(intToIp(i));
  }

  document.getElementById("network").textContent = intToIp(network);
  document.getElementById("broadcast").textContent = intToIp(broadcast);
  document.getElementById("gateway").textContent = usableIPs[0] || "-";
  document.getElementById("count").textContent = usableIPs.length;

  document.getElementById("ipList").innerHTML = usableIPs.join("<br>");
  document.getElementById("output").classList.remove("d-none");
}

function downloadCSV() {
  let csv = "IP Address\n" + usableIPs.join("\n");
  let blob = new Blob([csv], { type: "text/csv" });
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "usable_ips.csv";
  a.click();
}

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  pdf.text("Subnet Calculator - Kullanilabilir IP Listesi", 10, 10);

  let y = 20;
  usableIPs.forEach(ip => {
    if(y > 280){ pdf.addPage(); y = 10; }
    pdf.text(ip, 10, y);
    y += 7;
  });

  pdf.save("usable_ips.pdf");
}
</script>

</body>
</html>
